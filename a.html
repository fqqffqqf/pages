<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>24ç‚¹æ±‚è§£å™¨ - æ‰‹åŠ¨è¾“å…¥æ•°å­—</title>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      max-width: 700px;
      margin: 30px auto;
      padding: 20px;
      background-color: #f8f9fa;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
    }
    .input-area {
      text-align: center;
      margin: 20px 0;
    }
    input {
      width: 60px;
      padding: 8px;
      margin: 0 5px;
      font-size: 16px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #2ecc71;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #27ae60;
    }
    .solutions {
      margin-top: 20px;
    }
    .solution-item {
      background-color: #e8f4f8;
      padding: 10px;
      margin: 8px 0;
      border-left: 4px solid #3498db;
      font-family: monospace;
      font-size: 16px;
    }
    .error {
      color: #e74c3c;
      font-weight: bold;
    }
    .no-solution {
      color: #e67e22;
    }
  </style>
</head>
<body>
  <h1>ğŸ”¢ 24ç‚¹æ±‚è§£å™¨ï¼ˆæ‰‹åŠ¨è¾“å…¥ï¼‰</h1>
  <div class="input-area">
    <p>è¯·è¾“å…¥å››ä¸ªæ•°å­—ï¼š</p>
    <input type="text" id="n1" value="3">
    <input type="text" id="n2" value="3">
    <input type="text" id="n3" value="8">
    <input type="text" id="n4" value="8">
    <br>
    <button onclick="solve()">æ±‚è§£æ‰€æœ‰ 24 ç‚¹æ–¹æ¡ˆ</button>
  </div>
  <div id="result"></div>

  <script>
    function isEqual(a, b) {
      return Math.abs(a - b) < 1e-10;
    }

    function calculate(a, b, op) {
      switch (op) {
        case '+': return a + b;
        case '-': return a - b;
        case '*': return a * b;
        case '/': 
          if (isEqual(b, 0)) return NaN;
          return a / b;
        default: return NaN;
      }
    }

    function getPermutations(arr) {
      if (arr.length <= 1) return [arr];
      let result = [];
      for (let i = 0; i < arr.length; i++) {
        let first = arr[i];
        let rest = arr.slice(0, i).concat(arr.slice(i + 1));
        let perms = getPermutations(rest);
        for (let perm of perms) {
          result.push([first].concat(perm));
        }
      }
      return result;
    }

    function solve24(nums) {
      const ops = ['+', '-', '*', '/'];
      const perms = getPermutations(nums);
      const solutions = new Set();

      for (let p of perms) {
        const [a, b, c, d] = p;
        for (let o1 of ops)
        for (let o2 of ops)
        for (let o3 of ops) {
          // ç»“æ„1: ((a o1 b) o2 c) o3 d
          let v1 = calculate(calculate(calculate(a, b, o1), c, o2), d, o3);
          if (!isNaN(v1) && isEqual(v1, 24))
            solutions.add(`((${a} ${o1} ${b}) ${o2} ${c}) ${o3} ${d}`);

          // ç»“æ„2: (a o1 (b o2 c)) o3 d
          let v2 = calculate(calculate(a, calculate(b, c, o2), o1), d, o3);
          if (!isNaN(v2) && isEqual(v2, 24))
            solutions.add(`(${a} ${o1} (${b} ${o2} ${c})) ${o3} ${d}`);

          // ç»“æ„3: (a o1 b) o2 (c o3 d)
          let v3 = calculate(calculate(a, b, o1), calculate(c, d, o3), o2);
          if (!isNaN(v3) && isEqual(v3, 24))
            solutions.add(`(${a} ${o1} ${b}) ${o2} (${c} ${o3} ${d})`);

          // ç»“æ„4: a o1 ((b o2 c) o3 d)
          let v4 = calculate(a, calculate(calculate(b, c, o2), d, o3), o1);
          if (!isNaN(v4) && isEqual(v4, 24))
            solutions.add(`${a} ${o1} ((${b} ${o2} ${c}) ${o3} ${d})`);

          // ç»“æ„5: a o1 (b o2 (c o3 d))
          let v5 = calculate(a, calculate(b, calculate(c, d, o3), o2), o1);
          if (!isNaN(v5) && isEqual(v5, 24))
            solutions.add(`${a} ${o1} (${b} ${o2} (${c} ${o3} ${d}))`);
        }
      }
      return Array.from(solutions).sort();
    }

    function solve() {
      const n1 = parseFloat(document.getElementById('n1').value.trim());
      const n2 = parseFloat(document.getElementById('n2').value.trim());
      const n3 = parseFloat(document.getElementById('n3').value.trim());
      const n4 = parseFloat(document.getElementById('n4').value.trim());

      // æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆæ•°å­—
      if ([n1, n2, n3, n4].some(isNaN)) {
        document.getElementById('result').innerHTML = 
          '<p class="error">âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼ˆå¦‚ï¼š3, 3.5, -2ï¼‰</p>';
        return;
      }

      const nums = [n1, n2, n3, n4];
      const solutions = solve24(nums);

      const resDiv = document.getElementById('result');
      if (solutions.length === 0) {
        resDiv.innerHTML = `
          <p><strong>æ•°å­—: ${nums.join(', ')}</strong></p>
          <p class="no-solution">âŒ æ— è§£ï¼è¿™ç»„æ•°å­—æ— æ³•ç®—å‡º24ã€‚</p>
        `;
      } else {
        resDiv.innerHTML = `
          <p><strong>æ•°å­—: ${nums.join(', ')}</strong></p>
          <p>âœ… æ‰¾åˆ° ${solutions.length} ç§è§£æ³•ï¼š</p>
          ${solutions.map(s => `<div class="solution-item">${s} = 24</div>`).join('')}
        `;
      }
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ±‚è§£ç¤ºä¾‹ï¼ˆå¯é€‰ï¼‰
    window.onload = function() {
      solve(); // é»˜è®¤ç”¨ 3,3,8,8 æ±‚è§£ï¼ˆç»å…¸é¢˜ï¼š8/(3-8/3)=24ï¼‰
    };
  </script>
</body>
</html>
